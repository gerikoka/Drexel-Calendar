<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <title> Drexel Planner Homepage </title>
    <nav>
      <a href="./index.html">Home</a>
      <a href="./tester.html">tester</a>
    </nav>
    <style>
      body {
        margin: 0;
        padding: 0;
        display: flex;
        height: 100vh;
      }

      #calendar-container {
        margin-left: auto;
      }

      #calendar {
        width: 600px;
        height: 600px;
        margin: 20px;
      }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js'></script>
    <script src="{{ url_for('static', filename='index.global.js') }}"></script>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet'>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var calendarEl = document.getElementById('calendar');
        var holidays = [];

        // Function to calculate Martin Luther King Jr. Day
        function calculateMartinLutherKingJrDay(year) {
          // Calculate the third Monday in January
          var january = new Date(year, 0, 1);
          var dayOfWeek = january.getDay();
          var daysToAdd = dayOfWeek <= 1 ? 15 - dayOfWeek : 22 - dayOfWeek;
          var mlkDay = new Date(year, 0, daysToAdd + 1);
          return mlkDay;
        }

        // Function to calculate Presidents' Day
        function calculatePresidentsDay(year) {
          // Calculate the third Monday in February
          var february = new Date(year, 1, 1);
          var dayOfWeek = february.getDay();
          var daysToAdd = dayOfWeek <= 1 ? 15 - dayOfWeek : 22 - dayOfWeek;
          var presidentsDay = new Date(year, 1, daysToAdd + 1);
          return presidentsDay;
        }

        // Function to calculate Memorial Day
        function calculateMemorialDay(year) {
          // Start with May 31st and move backward to find the last Monday in May
          var may31 = new Date(year, 4, 31);
          while (may31.getDay() !== 1) {
            may31.setDate(may31.getDate() - 1);
          }
          return may31;
        }

        // Function to calculate Labor Day
        function calculateLaborDay(year) {
          // Find the first Monday in September
          var laborDay = new Date(year, 8, 1); // September is month 8 (0-based index)
          while (laborDay.getDay() !== 1) {
            laborDay.setDate(laborDay.getDate() + 1);
          }
          return laborDay;
        }

        // Function to calculate Columbus Day
        function calculateColumbusDay(year) {
          // Find the second Monday in October
          var columbusDay = new Date(year, 9, 1); // October is month 9 (0-based index)
          var count = 0;
          while (count < 2) {
            if (columbusDay.getDay() === 1) {
              count++;
            }
            if (count < 2) {
              columbusDay.setDate(columbusDay.getDate() + 1);
            }
          }
          return columbusDay;
        }

        // Function to calculate Thanksgiving Day
        function calculateThanksgivingDay(year) {
          // Find the fourth Thursday in November
          var thanksgivingDay = new Date(year, 10, 1); // November is month 10 (0-based index)
          var count = 0;
          while (count < 4) {
            if (thanksgivingDay.getDay() === 4) {
              count++;
            }
            if (count < 4) {
              thanksgivingDay.setDate(thanksgivingDay.getDate() + 1);
            }
          }
          return thanksgivingDay;
        }

        // Loop through years from 2020 to 2060
        for (var year = 2020; year <= 2060; year++) {
          // Add national holidays for the current year
          holidays.push(
            {
              title: "New Year's Day",
              start: year + '-01-01',
              allDay: true,
              color: 'red',
              backgroundColor: 'lightblue',
              borderColor: 'darkred',
              textColor: 'white'
            },
            {
              title: "Independence Day",
              start: year + '-07-04',
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Martin Luther King, Jr. Day",
              start: calculateMartinLutherKingJrDay(year),
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Presidents Day",
              start: calculatePresidentsDay(year),
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Memorial Day",
              start: calculateMemorialDay(year),
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Juneteenth",
              start: year + '-06-19',
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Labor Day",
              start: calculateLaborDay(year),
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Columbus Day",
              start: calculateColumbusDay(year),
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Veterans Day",
              start: year + '-11-11',
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Thanksgiving Day",
              start: calculateThanksgivingDay(year),
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            },
            {
              title: "Christmas Day",
              start: year + '-12-25',
              allDay: true,
              color: 'blue',
              backgroundColor: 'lightblue',
              borderColor: 'darkblue',
              textColor: 'white'
            }
          );
        }

        var calendar = new FullCalendar.Calendar(calendarEl, {
          themeSystem: 'bootstrap5',
          navLinks: true,
          headerToolbar: {
            left: 'prev,next',
            center: 'title',
            right: 'multiMonthYear,dayGridMonth,timeGridWeek,timeGridDay' // user can switch between the two
          },
          initialView: 'timeGridWeek',
          eventSources: [holidays, {{ events | tojson | safe }}] // Add the holidays array as an event source
        });

        calendar.render();
      });
    </script>
  </head>
  <body>
    <div id='calendar-container'>
    <div id='calendar'></div>
  </body>
</html>
